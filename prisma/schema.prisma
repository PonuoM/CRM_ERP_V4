generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model activities {
  id          BigInt   @id @default(autoincrement())
  customer_id Int?
  timestamp   DateTime @db.DateTime(0)
  type        String   @db.VarChar(64)
  description String   @db.Text
  actor_name  String   @db.VarChar(128)

  @@index([timestamp], map: "idx_activities_timestamp")
}

model ad_spend {
  id         Int      @id @default(autoincrement())
  page_id    Int
  spend_date DateTime @db.Date
  amount     Decimal  @default(0.00) @db.Decimal(12, 2)
  notes      String?  @db.VarChar(255)

  @@unique([page_id, spend_date], map: "uniq_page_date")
}

model address_districts {
  id          Int       @id
  name_th     String?   @db.VarChar(255)
  name_en     String?   @db.VarChar(255)
  province_id Int?
  created_at  DateTime? @db.Timestamp(0)
  updated_at  DateTime? @db.Timestamp(0)
  deleted_at  DateTime? @db.Timestamp(0)

  @@index([province_id], map: "province_id")
}

model address_geographies {
  id         Int       @id
  name       String?   @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)
  deleted_at DateTime? @db.Timestamp(0)
}

model address_provinces {
  id           Int       @id
  name_th      String?   @db.VarChar(255)
  name_en      String?   @db.VarChar(255)
  geography_id Int?
  created_at   DateTime? @db.Timestamp(0)
  updated_at   DateTime? @db.Timestamp(0)
  deleted_at   DateTime? @db.Timestamp(0)

  @@index([geography_id], map: "geography_id")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model address_sub_districts {
  id          Int
  zip_code    String?   @db.VarChar(10)
  name_th     String?   @db.VarChar(255)
  name_en     String?   @db.VarChar(255)
  district_id Int?
  lat         Decimal?  @db.Decimal(10, 8)
  long        Decimal?  @db.Decimal(11, 8)
  created_at  DateTime? @db.Timestamp(0)
  updated_at  DateTime? @db.Timestamp(0)
  deleted_at  DateTime? @db.Timestamp(0)

  @@ignore
}

model appointments {
  id              Int      @id @default(autoincrement())
  customer_id     Int?
  customer_ref_id String?  @db.VarChar(64)
  date            DateTime @db.DateTime(0)
  title           String   @db.VarChar(255)
  status          String   @db.VarChar(64)
  notes           String?  @db.Text

  @@index([date], map: "idx_appointments_date")
  @@index([status], map: "idx_appointments_status")
}

model bank_account {
  id                          Int                           @id @default(autoincrement())
  company_id                  Int
  bank                        String                        @db.VarChar(100)
  bank_number                 String                        @db.VarChar(50)
  is_active                   Boolean?                      @default(true)
  created_at                  DateTime                      @default(now()) @db.DateTime(0)
  updated_at                  DateTime                      @default(now()) @db.DateTime(0)
  deleted_at                  DateTime?                     @db.DateTime(0)
  order_slips                 order_slips[]
  statement_reconcile_batches statement_reconcile_batches[]

  @@index([company_id], map: "idx_company_id")
  @@index([is_active], map: "idx_is_active")
}

model call_history {
  id          Int      @id @default(autoincrement())
  customer_id Int?
  date        DateTime @db.DateTime(0)
  caller      String   @db.VarChar(128)
  status      String   @db.VarChar(64)
  result      String   @db.VarChar(255)
  crop_type   String?  @db.VarChar(128)
  area_size   String?  @db.VarChar(128)
  notes       String?  @db.Text
  duration    Decimal? @db.Decimal(12, 2)
}

model cod_documents {
  id                       Int             @id @default(autoincrement())
  document_number          String          @db.VarChar(64)
  document_datetime        DateTime        @db.DateTime(0)
  bank_account_id          Int?
  matched_statement_log_id Int?
  company_id               Int
  total_input_amount       Decimal         @default(0.00) @db.Decimal(12, 2)
  total_order_amount       Decimal         @default(0.00) @db.Decimal(12, 2)
  status                   String          @default("pending") @db.VarChar(32)
  notes                    String?         @db.Text
  created_by               Int?
  verified_by              Int?
  verified_at              DateTime?       @db.DateTime(0)
  created_at               DateTime        @default(now()) @db.DateTime(0)
  updated_at               DateTime        @default(now()) @db.DateTime(0)
  statement_logs           statement_logs? @relation(fields: [matched_statement_log_id], references: [id], onUpdate: NoAction, map: "fk_cod_documents_statement")
  users                    users?          @relation(fields: [verified_by], references: [id], onUpdate: NoAction, map: "fk_cod_documents_verified_by")
  cod_records              cod_records[]

  @@unique([company_id, document_number], map: "uniq_cod_document_company_number")
  @@index([bank_account_id], map: "fk_cod_documents_bank")
  @@index([created_by], map: "fk_cod_documents_creator")
  @@index([verified_by], map: "fk_cod_documents_verified_by")
  @@index([company_id], map: "idx_cod_documents_company")
  @@index([document_datetime], map: "idx_cod_documents_datetime")
  @@index([matched_statement_log_id], map: "idx_cod_documents_statement")
  @@index([status], map: "idx_cod_documents_status")
}

model cod_records {
  id                  Int            @id @default(autoincrement())
  document_id         Int?
  tracking_number     String         @db.VarChar(128)
  order_id            String?        @db.VarChar(32)
  delivery_start_date DateTime?      @db.Date
  delivery_end_date   DateTime?      @db.Date
  cod_amount          Decimal        @default(0.00) @db.Decimal(12, 2)
  order_amount        Decimal?       @default(0.00) @db.Decimal(12, 2)
  received_amount     Decimal?       @default(0.00) @db.Decimal(12, 2)
  difference          Decimal?       @default(0.00) @db.Decimal(12, 2)
  status              String         @default("pending") @db.VarChar(32)
  company_id          Int
  created_by          Int?
  created_at          DateTime       @default(now()) @db.DateTime(0)
  updated_at          DateTime?      @db.DateTime(0)
  cod_documents       cod_documents? @relation(fields: [document_id], references: [id], onUpdate: NoAction, map: "fk_cod_records_document")

  @@index([created_by], map: "fk_cod_records_creator")
  @@index([document_id], map: "idx_cod_records_document")
  @@index([order_id], map: "idx_cod_records_order")
  @@index([company_id], map: "idx_company")
  @@index([status], map: "idx_status")
  @@index([tracking_number], map: "idx_tracking")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model commission_order_lines {
  id                 Int                @id @default(autoincrement())
  record_id          Int
  order_id           String             @db.VarChar(32)
  order_date         DateTime           @db.Date
  confirmed_at       DateTime           @db.DateTime(0)
  order_amount       Decimal            @db.Decimal(12, 2)
  commission_amount  Decimal            @db.Decimal(12, 2)
  created_at         DateTime?          @default(now()) @db.DateTime(0)
  commission_records commission_records @relation(fields: [record_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "commission_order_lines_ibfk_1")

  @@index([order_id], map: "idx_commission_order")
  @@index([record_id], map: "record_id")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model commission_periods {
  id                 Int                  @id @default(autoincrement())
  company_id         Int
  period_month       Int
  period_year        Int
  order_month        Int
  order_year         Int
  cutoff_date        DateTime             @db.Date
  status             String?              @default("Draft") @db.VarChar(20)
  total_sales        Decimal?             @default(0.00) @db.Decimal(14, 2)
  total_commission   Decimal?             @default(0.00) @db.Decimal(14, 2)
  total_orders       Int?                 @default(0)
  calculated_at      DateTime?            @db.DateTime(0)
  calculated_by      Int?
  approved_at        DateTime?            @db.DateTime(0)
  approved_by        Int?
  paid_at            DateTime?            @db.DateTime(0)
  notes              String?              @db.Text
  created_at         DateTime?            @default(now()) @db.DateTime(0)
  updated_at         DateTime?            @default(now()) @db.DateTime(0)
  commission_records commission_records[]

  @@unique([company_id, period_year, period_month], map: "unique_period")
  @@index([company_id, period_year, period_month], map: "idx_period_company")
  @@index([status], map: "idx_period_status")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model commission_records {
  id                     Int                      @id @default(autoincrement())
  period_id              Int
  user_id                Int
  total_sales            Decimal                  @default(0.00) @db.Decimal(12, 2)
  commission_rate        Decimal?                 @db.Decimal(5, 2)
  commission_amount      Decimal                  @default(0.00) @db.Decimal(12, 2)
  order_count            Int?                     @default(0)
  notes                  String?                  @db.Text
  created_at             DateTime?                @default(now()) @db.DateTime(0)
  commission_order_lines commission_order_lines[]
  commission_periods     commission_periods       @relation(fields: [period_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "commission_records_ibfk_1")
  users                  users                    @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "commission_records_ibfk_2")

  @@index([period_id, user_id], map: "idx_commission_period_user")
  @@index([user_id], map: "user_id")
}

model companies {
  id         Int       @id @default(autoincrement())
  name       String    @db.VarChar(255)
  address    String?   @db.Text
  phone      String?   @db.VarChar(64)
  email      String?   @db.VarChar(255)
  tax_id     String?   @db.VarChar(32)
  created_at DateTime? @default(now()) @db.DateTime(0)
  updated_at DateTime? @default(now()) @db.DateTime(0)
}

model customer_address {
  id                   Int       @id @default(autoincrement())
  customer_id          String    @db.VarChar(255)
  address              String?   @db.VarChar(255)
  recipient_first_name String?   @db.VarChar(128)
  recipient_last_name  String?   @db.VarChar(128)
  province             String?   @db.VarChar(100)
  district             String?   @db.VarChar(100)
  sub_district         String?   @db.VarChar(100)
  zip_code             String?   @db.VarChar(10)
  created_at           DateTime? @default(now()) @db.Timestamp(0)
  updated_at           DateTime? @default(now()) @db.Timestamp(0)

  @@index([customer_id], map: "customer_id")
}

model customer_assignment_history {
  id          BigInt   @id @default(autoincrement())
  customer_id Int?
  user_id     Int
  assigned_at DateTime @default(now()) @db.DateTime(0)

  @@index([user_id], map: "fk_cah_user")
}

model customer_blocks {
  id           Int       @id @default(autoincrement())
  customer_id  String    @db.VarChar(64)
  reason       String    @db.Text
  blocked_by   Int
  blocked_at   DateTime  @db.DateTime(0)
  unblocked_by Int?
  unblocked_at DateTime? @db.DateTime(0)
  active       Boolean   @default(true)
}

model customer_logs {
  id               Int                             @id @default(autoincrement())
  customer_id      String                          @db.VarChar(32)
  bucket_type      String?                         @db.VarChar(16)
  lifecycle_status customer_logs_lifecycle_status?
  assigned_to      Int?
  action_type      customer_logs_action_type?      @default(update)
  old_values       Json?
  new_values       Json?
  changed_fields   Json?
  created_by       Int?
  created_at       DateTime?                       @default(now()) @db.Timestamp(0)

  @@index([assigned_to], map: "idx_assigned_to")
  @@index([created_at], map: "idx_created_at")
  @@index([customer_id], map: "idx_customer_id")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model customer_tags {
  customer_id String? @db.VarChar(64)
  tag_id      Int

  @@index([tag_id], map: "fk_customer_tags_tag")
  @@ignore
}

model customers {
  customer_id               Int                          @id @default(autoincrement())
  customer_ref_id           String                       @unique(map: "uniq_customers_customer_ref_id") @db.VarChar(64)
  first_name                String                       @db.VarChar(128)
  last_name                 String                       @db.VarChar(128)
  phone                     String                       @db.VarChar(64)
  backup_phone              String?                      @db.VarChar(64)
  email                     String?                      @db.VarChar(255)
  province                  String                       @db.VarChar(128)
  company_id                Int
  assigned_to               Int?
  date_assigned             DateTime                     @db.DateTime(0)
  date_registered           DateTime?                    @db.DateTime(0)
  follow_up_date            DateTime?                    @db.DateTime(0)
  ownership_expires         DateTime?                    @db.DateTime(0)
  lifecycle_status          customers_lifecycle_status?
  behavioral_status         customers_behavioral_status?
  grade                     customers_grade?
  total_purchases           Decimal                      @default(0.00) @db.Decimal(12, 2)
  total_calls               Int                          @default(0)
  facebook_name             String?                      @db.VarChar(255)
  line_id                   String?                      @db.VarChar(128)
  street                    String?                      @db.VarChar(255)
  subdistrict               String?                      @db.VarChar(128)
  district                  String?                      @db.VarChar(128)
  postal_code               String?                      @db.VarChar(16)
  recipient_first_name      String?                      @db.VarChar(128)
  recipient_last_name       String?                      @db.VarChar(128)
  has_sold_before           Boolean?                     @default(false)
  follow_up_count           Int?                         @default(0)
  last_follow_up_date       DateTime?                    @db.DateTime(0)
  last_sale_date            DateTime?                    @db.DateTime(0)
  is_in_waiting_basket      Boolean?                     @default(false)
  waiting_basket_start_date DateTime?                    @db.DateTime(0)
  followup_bonus_remaining  Boolean                      @default(true)
  is_blocked                Boolean                      @default(false)
  first_order_date          DateTime?                    @db.DateTime(0)
  last_order_date           DateTime?                    @db.DateTime(0)
  order_count               Int?                         @default(0)
  is_new_customer           Boolean?                     @default(false)
  is_repeat_customer        Boolean?                     @default(false)
  bucket_type               String?                      @db.VarChar(16)
  ai_last_updated           DateTime?                    @db.DateTime(0)
  ai_reason_thai            String?                      @db.Text
  ai_score                  Int?

  @@index([assigned_to], map: "idx_customers_assigned_to")
  @@index([is_blocked], map: "idx_customers_blocked")
  @@index([company_id], map: "idx_customers_company")
  @@index([company_id, assigned_to], map: "idx_customers_company_assigned")
  @@index([company_id, lifecycle_status], map: "idx_customers_company_status")
  @@index([date_assigned], map: "idx_customers_date_assigned")
  @@index([lifecycle_status], map: "idx_customers_lifecycle_status")
  @@index([ownership_expires], map: "idx_customers_ownership_expires")
  @@index([is_in_waiting_basket], map: "idx_customers_waiting")
}

model env {
  id         Int       @id @default(autoincrement())
  key        String    @unique(map: "key") @db.VarChar(255)
  value      String?   @db.Text
  company_id Int?
  created_at DateTime? @default(now()) @db.Timestamp(0)
  updated_at DateTime? @default(now()) @db.Timestamp(0)

  @@index([key], map: "idx_env_key")
}

model exports {
  id             Int      @id @default(autoincrement())
  company_id     Int?
  category       String?  @db.VarChar(100)
  filename       String   @db.VarChar(255)
  file_path      String   @db.VarChar(1024)
  orders_count   Int
  user_id        Int?
  exported_by    String?  @db.VarChar(128)
  created_at     DateTime @default(now()) @db.DateTime(0)
  download_count Int      @default(0)

  @@index([category], map: "idx_exports_category")
  @@index([company_id], map: "idx_exports_company")
  @@index([created_at], map: "idx_exports_created_at")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model google_sheet_shipping {
  id                  Int       @id @default(autoincrement())
  system_created_time DateTime  @db.DateTime(0)
  order_number        String    @db.VarChar(128)
  order_status        String?   @db.VarChar(50)
  delivery_date       DateTime? @db.Date
  delivery_status     String?   @db.VarChar(100)
  imported_at         DateTime  @default(now()) @db.DateTime(0)
  updated_at          DateTime  @default(now()) @db.DateTime(0)

  @@index([delivery_date], map: "idx_delivery_date")
  @@index([delivery_status], map: "idx_delivery_status")
  @@index([order_number], map: "idx_order_number")
  @@index([order_status], map: "idx_order_status")
  @@index([order_number, system_created_time], map: "idx_order_time")
}

model marketing_ads_log {
  id          Int       @id @default(autoincrement())
  page_id     Int
  user_id     Int
  date        DateTime  @db.Date
  ads_cost    Int?
  impressions Int?
  reach       Int?
  clicks      Int?
  created_at  DateTime? @default(now()) @db.Timestamp(0)
  updated_at  DateTime? @default(now()) @db.Timestamp(0)

  @@unique([page_id, user_id, date], map: "unique_page_user_date")
  @@index([created_at], map: "idx_created_at")
  @@index([date], map: "idx_date")
  @@index([page_id], map: "idx_page_id")
  @@index([user_id], map: "idx_user_id")
}

model marketing_product_ads_log {
  id          Int       @id @default(autoincrement())
  user_id     Int
  product_id  Int
  date        DateTime  @db.Date
  ads_cost    Decimal?  @db.Decimal(10, 2)
  impressions Int?
  reach       Int?
  clicks      Int?
  created_at  DateTime? @default(now()) @db.Timestamp(0)
  updated_at  DateTime? @default(now()) @db.Timestamp(0)
  products    products  @relation(fields: [product_id], references: [id], onDelete: Cascade, map: "fk_marketing_pad_product_id")
  users       users     @relation(fields: [user_id], references: [id], onDelete: Cascade, map: "fk_marketing_pad_user_id")

  @@unique([user_id, product_id, date], map: "unique_user_product_date")
  @@index([date], map: "idx_date")
  @@index([product_id], map: "idx_product_id")
  @@index([user_id], map: "idx_user_id")
}

model marketing_user_page {
  id         Int       @id @default(autoincrement())
  page_id    Int
  user_id    Int
  created_at DateTime? @default(now()) @db.Timestamp(0)
  updated_at DateTime? @default(now()) @db.Timestamp(0)

  @@unique([page_id, user_id], map: "unique_page_user")
  @@index([page_id], map: "idx_page_id")
  @@index([user_id], map: "idx_user_id")
}

model marketing_user_product {
  id         Int       @id @default(autoincrement())
  user_id    Int
  product_id Int
  created_at DateTime? @default(now()) @db.Timestamp(0)
  updated_at DateTime? @default(now()) @db.Timestamp(0)
  products   products  @relation(fields: [product_id], references: [id], onDelete: Cascade, map: "fk_marketing_user_product_product_id")
  users      users     @relation(fields: [user_id], references: [id], onDelete: Cascade, map: "fk_marketing_user_product_user_id")

  @@unique([user_id, product_id], map: "unique_user_product")
  @@index([product_id], map: "idx_product_id")
  @@index([user_id], map: "idx_user_id")
}

model notification_read_status {
  id              Int       @id @default(autoincrement())
  notification_id String    @db.VarChar(50)
  user_id         Int
  read_at         DateTime? @default(now()) @db.DateTime(0)
  created_at      DateTime? @default(now()) @db.DateTime(0)

  @@unique([notification_id, user_id], map: "unique_notification_user_read")
  @@index([read_at], map: "idx_read_at")
  @@index([user_id], map: "idx_user_id")
}

model notification_roles {
  id              Int                     @id @default(autoincrement())
  notification_id String                  @db.VarChar(50)
  role            notification_roles_role
  created_at      DateTime?               @default(now()) @db.DateTime(0)

  @@unique([notification_id, role], map: "unique_notification_role")
  @@index([role], map: "idx_role")
}

model notification_settings {
  id                  Int       @id @default(autoincrement())
  user_id             Int
  notification_type   String    @db.VarChar(50)
  in_app_enabled      Boolean?  @default(true)
  email_enabled       Boolean?  @default(false)
  sms_enabled         Boolean?  @default(false)
  business_hours_only Boolean?  @default(false)
  created_at          DateTime? @default(now()) @db.DateTime(0)
  updated_at          DateTime? @default(now()) @db.DateTime(0)

  @@unique([user_id, notification_type], map: "unique_user_notification_type")
  @@index([notification_type], map: "idx_notification_type")
  @@index([user_id], map: "idx_user_id")
}

model notification_users {
  id              Int       @id @default(autoincrement())
  notification_id String    @db.VarChar(50)
  user_id         Int
  created_at      DateTime? @default(now()) @db.DateTime(0)

  @@unique([notification_id, user_id], map: "unique_notification_user")
  @@index([user_id], map: "idx_user_id")
}

model notifications {
  id                String                  @id @db.VarChar(50)
  type              notifications_type
  category          notifications_category
  title             String                  @db.VarChar(255)
  message           String                  @db.Text
  timestamp         DateTime                @default(now()) @db.DateTime(0)
  is_read           Boolean?                @default(false)
  priority          notifications_priority? @default(medium)
  related_id        String?                 @db.VarChar(50)
  page_id           Int?
  page_name         String?                 @db.VarChar(255)
  platform          String?                 @db.VarChar(50)
  previous_value    Decimal?                @db.Decimal(10, 2)
  current_value     Decimal?                @db.Decimal(10, 2)
  percentage_change Decimal?                @db.Decimal(5, 2)
  action_url        String?                 @db.VarChar(255)
  action_text       String?                 @db.VarChar(100)
  metadata          Json?
  created_at        DateTime?               @default(now()) @db.DateTime(0)
  updated_at        DateTime?               @default(now()) @db.DateTime(0)

  @@index([category], map: "idx_category")
  @@index([is_read], map: "idx_is_read")
  @@index([page_id], map: "idx_page_id")
  @@index([priority], map: "idx_priority")
  @@index([related_id], map: "idx_related_id")
  @@index([timestamp], map: "idx_timestamp")
  @@index([type], map: "idx_type")
}

model onecall_batch {
  id            Int       @id @default(autoincrement())
  startdate     DateTime  @db.Date
  enddate       DateTime  @db.Date
  amount_record Int
  created_at    DateTime? @default(now()) @db.Timestamp(0)
}

model onecall_log {
  id             Int      @id @default(autoincrement())
  timestamp      DateTime @db.Timestamp(0)
  duration       Int
  localParty     String   @db.VarChar(255)
  remoteParty    String   @db.VarChar(255)
  direction      String   @db.VarChar(10)
  phone_telesale String   @db.VarChar(255)
  batch_id       Int

  @@index([phone_telesale, timestamp], map: "idx_onecall_phone_ts")
  @@index([batch_id], map: "onecall_log_ibfk_1")
}

model order_box_collection_logs {
  id                    Int                                           @id @default(autoincrement())
  order_box_id          Int
  order_id              String                                        @db.VarChar(32)
  sub_order_id          String                                        @db.VarChar(64)
  box_number            Int
  change_type           order_box_collection_logs_change_type
  old_collection_amount Decimal?                                      @db.Decimal(12, 2)
  new_collection_amount Decimal?                                      @db.Decimal(12, 2)
  old_collected_amount  Decimal?                                      @db.Decimal(12, 2)
  new_collected_amount  Decimal?                                      @db.Decimal(12, 2)
  old_waived_amount     Decimal?                                      @db.Decimal(12, 2)
  new_waived_amount     Decimal?                                      @db.Decimal(12, 2)
  old_payment_method    order_box_collection_logs_old_payment_method?
  new_payment_method    order_box_collection_logs_new_payment_method?
  old_status            order_box_collection_logs_old_status?
  new_status            order_box_collection_logs_new_status?
  notes                 String?                                       @db.Text
  created_at            DateTime                                      @default(now()) @db.DateTime(0)

  @@index([order_box_id], map: "idx_ob_logs_box")
  @@index([change_type], map: "idx_ob_logs_change_type")
  @@index([order_id], map: "idx_ob_logs_order")
  @@index([sub_order_id], map: "idx_ob_logs_sub_order")
}

model order_boxes {
  id                Int                         @id @default(autoincrement())
  order_id          String                      @db.VarChar(32)
  sub_order_id      String                      @unique(map: "uniq_sub_order_id") @default("") @db.VarChar(64)
  box_number        Int
  payment_method    order_boxes_payment_method? @default(COD)
  status            order_boxes_status          @default(PENDING)
  cod_amount        Decimal                     @default(0.00) @db.Decimal(12, 2)
  collection_amount Decimal                     @default(0.00) @db.Decimal(12, 2)
  collected_amount  Decimal                     @default(0.00) @db.Decimal(12, 2)
  waived_amount     Decimal                     @default(0.00) @db.Decimal(12, 2)
  created_at        DateTime                    @default(now()) @db.DateTime(0)
  updated_at        DateTime                    @default(now()) @db.DateTime(0)
  shipped_at        DateTime?                   @db.DateTime(0)
  delivered_at      DateTime?                   @db.DateTime(0)

  @@unique([order_id, box_number], map: "uniq_order_box_per_order")
  @@index([status], map: "idx_order_boxes_status")
}

model order_item_allocations {
  id                 Int                           @id @default(autoincrement())
  order_id           String                        @db.VarChar(32)
  order_item_id      Int?
  product_id         Int
  promotion_id       Int?
  is_freebie         Boolean                       @default(false)
  required_quantity  Int
  allocated_quantity Int                           @default(0)
  warehouse_id       Int?
  lot_number         String?                       @db.VarChar(128)
  status             order_item_allocations_status @default(PENDING)
  notes              String?                       @db.Text
  created_by         Int?
  created_at         DateTime                      @default(now()) @db.DateTime(0)
  updated_at         DateTime                      @default(now()) @db.DateTime(0)

  @@index([promotion_id], map: "fk_allocations_promotion")
  @@index([created_by], map: "idx_allocations_created_by")
  @@index([order_item_id], map: "idx_allocations_item")
  @@index([order_id], map: "idx_allocations_order")
  @@index([product_id], map: "idx_allocations_product")
  @@index([status], map: "idx_allocations_status")
  @@index([warehouse_id], map: "idx_allocations_warehouse")
}

model order_items {
  id                  Int     @id @default(autoincrement())
  order_id            String  @db.VarChar(32)
  parent_order_id     String  @db.VarChar(32)
  creator_id          Int
  product_id          Int?
  product_name        String? @db.VarChar(255)
  quantity            Int
  price_per_unit      Decimal @db.Decimal(12, 2)
  discount            Decimal @default(0.00) @db.Decimal(12, 2)
  net_total           Decimal @default(0.00) @db.Decimal(12, 2)
  is_freebie          Boolean @default(false)
  box_number          Int?
  promotion_id        Int?
  parent_item_id      Int?
  is_promotion_parent Boolean @default(false)

  @@index([order_id], map: "fk_order_items_order")
  @@index([creator_id], map: "idx_order_items_creator")
  @@index([parent_item_id], map: "idx_order_items_parent")
  @@index([parent_order_id], map: "idx_order_items_parent_order")
  @@index([product_id], map: "idx_order_items_product")
  @@index([promotion_id], map: "idx_order_items_promotion")
  @@index([is_promotion_parent], map: "idx_order_items_promotion_parent")
}

model order_sequences {
  id            Int                    @id @default(autoincrement())
  company_id    Int
  period        order_sequences_period @default(day)
  prefix        String                 @db.VarChar(8)
  last_sequence Int                    @default(0)
  updated_at    DateTime               @default(now()) @db.DateTime(0)

  @@unique([company_id, period, prefix], map: "uniq_order_sequences")
}

model order_slips {
  id              Int           @id @default(autoincrement())
  amount          Decimal?      @db.Decimal(12, 2)
  bank_account_id Int?
  transfer_date   DateTime?     @db.DateTime(0)
  order_id        String        @db.VarChar(32)
  url             String        @db.VarChar(1024)
  upload_by       Int?
  upload_by_name  String?       @db.VarChar(255)
  created_at      DateTime      @default(now()) @db.DateTime(0)
  updated_at      DateTime      @default(now()) @db.DateTime(0)
  bank_account    bank_account? @relation(fields: [bank_account_id], references: [id], onUpdate: NoAction, map: "fk_order_slips_bank_account_id")

  @@index([bank_account_id], map: "idx_order_slips_bank_account_id")
  @@index([order_id], map: "idx_order_slips_order")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model order_status_logs {
  id                Int      @id @default(autoincrement())
  order_id          String   @db.VarChar(32)
  previous_status   String?  @db.VarChar(50)
  new_status        String?  @db.VarChar(50)
  previous_tracking String?  @db.VarChar(100)
  new_tracking      String?  @db.VarChar(100)
  changed_at        DateTime @default(now()) @db.DateTime(0)
  trigger_type      String   @db.VarChar(20)

  @@index([changed_at], map: "idx_order_log_changed_at")
  @@index([order_id], map: "idx_order_log_order_id")
}

model order_tracking_numbers {
  id              Int    @id @default(autoincrement())
  order_id        String @db.VarChar(32)
  parent_order_id String @db.VarChar(32)
  box_number      Int?
  tracking_number String @db.VarChar(128)

  @@index([order_id], map: "fk_order_tracking_order")
  @@index([parent_order_id], map: "idx_order_tracking_parent_order")
}

model orders {
  id                       String                     @id @db.VarChar(32)
  customer_id              Int?
  customer_type            String?                    @db.VarChar(50)
  company_id               Int
  creator_id               Int
  order_date               DateTime                   @db.DateTime(0)
  delivery_date            DateTime?                  @db.DateTime(0)
  street                   String?                    @db.VarChar(255)
  subdistrict              String?                    @db.VarChar(128)
  district                 String?                    @db.VarChar(128)
  province                 String?                    @db.VarChar(128)
  postal_code              String?                    @db.VarChar(16)
  recipient_first_name     String?                    @db.VarChar(128)
  recipient_last_name      String?                    @db.VarChar(128)
  shipping_provider        String?                    @db.VarChar(128)
  shipping_cost            Decimal                    @default(0.00) @db.Decimal(12, 2)
  bill_discount            Decimal                    @default(0.00) @db.Decimal(12, 2)
  total_amount             Decimal                    @default(0.00) @db.Decimal(12, 2)
  payment_method           orders_payment_method?
  payment_status           orders_payment_status?
  slip_url                 String?                    @db.VarChar(1024)
  amount_paid              Decimal?                   @db.Decimal(12, 2)
  cod_amount               Decimal?                   @db.Decimal(12, 2)
  order_status             orders_order_status        @default(Pending)
  notes                    String?                    @db.Text
  ocr_payment_date         DateTime?                  @db.DateTime(0)
  sales_channel            String?                    @db.VarChar(128)
  sales_channel_page_id    Int?
  bank_account_id          Int?
  transfer_date            DateTime?                  @db.DateTime(0)
  warehouse_id             Int?
  statement_reconcile_logs statement_reconcile_logs[]

  @@index([customer_id], map: "fk_orders_customer")
  @@index([sales_channel_page_id], map: "fk_orders_page")
  @@index([warehouse_id], map: "fk_orders_warehouse")
  @@index([bank_account_id], map: "idx_orders_bank_account_id")
  @@index([company_id], map: "idx_orders_company")
  @@index([company_id, payment_status], map: "idx_orders_company_payment")
  @@index([company_id, order_status], map: "idx_orders_company_status")
  @@index([creator_id], map: "idx_orders_creator")
  @@index([order_date], map: "idx_orders_date")
  @@index([delivery_date], map: "idx_orders_delivery_date")
  @@index([payment_status], map: "idx_orders_payment_status")
  @@index([order_status], map: "idx_orders_status")
}

model page_engagement_batch {
  id            Int                          @id @default(autoincrement())
  date_range    String                       @db.VarChar(100)
  created_at    DateTime                     @default(now()) @db.Timestamp(0)
  status        page_engagement_batch_status @default(pending)
  records_count Int?
  user_id       Int?

  @@index([created_at], map: "idx_created_at")
  @@index([status], map: "idx_status")
}

model page_engagement_log {
  id                            Int      @id @default(autoincrement())
  batch_id                      Int
  page_id                       String   @db.VarChar(50)
  date                          DateTime @db.Date
  inbox                         Int?     @default(0)
  comment                       Int?     @default(0)
  total                         Int?     @default(0)
  new_customer_replied          Int?     @default(0)
  customer_engagement_new_inbox Int?     @default(0)
  order_count                   Int?     @default(0)
  old_order_count               Int?     @default(0)

  @@index([batch_id], map: "idx_batch_id")
  @@index([date], map: "idx_date")
  @@index([page_id], map: "idx_page_id")
}

model page_list_user {
  id            Int       @id @default(autoincrement())
  page_id       String    @db.VarChar(255)
  page_user_id  String    @db.VarChar(255)
  status        String    @default("active") @db.VarChar(50)
  still_in_list Boolean   @default(true)
  created_at    DateTime? @default(now()) @db.Timestamp(0)
  updated_at    DateTime? @default(now()) @db.Timestamp(0)

  @@unique([page_id, page_user_id], map: "unique_page_user_pair")
  @@index([created_at], map: "idx_created_at")
  @@index([page_id], map: "idx_page_id")
  @@index([page_user_id], map: "idx_page_user_id")
  @@index([status], map: "idx_status")
  @@index([still_in_list], map: "idx_still_in_list")
  @@index([updated_at], map: "idx_updated_at")
}

model page_stats_batch {
  id         Int       @id @default(autoincrement())
  date_range String    @db.VarChar(255)
  created_at DateTime? @default(now()) @db.Timestamp(0)

  @@index([created_at], map: "idx_created_at")
  @@index([date_range], map: "idx_date_range")
}

model page_stats_log {
  id                       Int    @id @default(autoincrement())
  batch_id                 Int
  page_id                  String @db.VarChar(255)
  time_column              String @db.VarChar(255)
  new_customers            Int    @default(0)
  total_phones             Int    @default(0)
  new_phones               Int    @default(0)
  total_comments           Int    @default(0)
  total_chats              Int    @default(0)
  total_page_comments      Int    @default(0)
  total_page_chats         Int    @default(0)
  new_chats                Int    @default(0)
  chats_from_old_customers Int    @default(0)
  web_logged_in            Int    @default(0)
  web_guest                Int    @default(0)
  orders_count             Int    @default(0)

  @@unique([batch_id, page_id, time_column], map: "unique_batch_page_time")
  @@index([batch_id], map: "idx_batch_id")
  @@index([page_id], map: "idx_page_id")
  @@index([time_column], map: "idx_time_column")
}

model page_user {
  id             Int       @id @default(autoincrement())
  user_id        Int?
  page_user_id   String    @unique(map: "uk_page_user_id") @db.VarChar(255)
  page_user_name String    @db.VarChar(255)
  page_count     Int       @default(0)
  created_at     DateTime? @default(now()) @db.Timestamp(0)
  updated_at     DateTime? @default(now()) @db.Timestamp(0)

  @@index([created_at], map: "idx_created_at")
  @@index([page_user_id], map: "idx_page_user_id")
  @@index([page_user_name], map: "idx_page_user_name")
  @@index([updated_at], map: "idx_updated_at")
  @@index([user_id], map: "idx_user_id")
}

model pages {
  id                Int       @id @default(autoincrement())
  page_id           String?   @db.VarChar(255)
  name              String    @db.VarChar(255)
  platform          String    @default("Facebook") @db.VarChar(64)
  page_type         String?   @db.VarChar(50)
  url               String?   @db.VarChar(1024)
  company_id        Int
  active            Boolean   @default(true)
  still_in_list     Boolean   @default(true)
  user_count        Int       @default(0)
  created_at        DateTime? @default(now()) @db.Timestamp(0)
  updated_at        DateTime? @default(now()) @db.Timestamp(0)
  display_name      String?   @db.VarChar(255)
  sell_product_type String?   @db.VarChar(255)

  @@index([page_id], map: "idx_page_id")
  @@index([page_type], map: "idx_page_type")
  @@index([active], map: "idx_pages_active")
  @@index([company_id], map: "idx_pages_company")
  @@index([still_in_list], map: "idx_still_in_list")
  @@index([user_count], map: "idx_user_count")
}

model platforms {
  id              Int       @id @default(autoincrement())
  name            String    @db.VarChar(64)
  display_name    String    @db.VarChar(128)
  description     String?   @db.VarChar(255)
  company_id      Int       @default(1)
  active          Boolean   @default(true)
  sort_order      Int       @default(0)
  show_pages_from String?   @db.VarChar(64)
  created_at      DateTime? @default(now()) @db.Timestamp(0)
  updated_at      DateTime? @default(now()) @db.Timestamp(0)
  role_show       String?   @db.VarChar(255)

  @@unique([company_id, name], map: "uk_platforms_company_name")
  @@index([active], map: "idx_platforms_active")
  @@index([company_id], map: "idx_platforms_company_id")
  @@index([show_pages_from], map: "idx_platforms_show_pages_from")
  @@index([sort_order], map: "idx_platforms_sort_order")
}

model product_lots {
  id                 Int                  @id @default(autoincrement())
  lot_number         String               @db.VarChar(128)
  product_id         Int
  warehouse_id       Int
  purchase_date      DateTime             @db.Date
  expiry_date        DateTime?            @db.Date
  quantity_received  Decimal              @db.Decimal(12, 2)
  quantity_remaining Decimal              @default(0.00) @db.Decimal(12, 2)
  unit_cost          Decimal              @db.Decimal(12, 2)
  supplier_id        Int?
  supplier_invoice   String?              @db.VarChar(128)
  status             product_lots_status? @default(Active)
  notes              String?              @db.Text
  created_at         DateTime?            @default(now()) @db.DateTime(0)
  updated_at         DateTime?            @default(now()) @db.DateTime(0)

  @@unique([product_id, lot_number], map: "idx_product_lot_unique")
  @@index([expiry_date], map: "idx_lot_expiry")
  @@index([status], map: "idx_lot_status")
  @@index([warehouse_id], map: "product_lots_ibfk_2")
}

model products {
  id                        Int                         @id @default(autoincrement())
  sku                       String                      @db.VarChar(64)
  name                      String                      @db.VarChar(255)
  description               String?                     @db.Text
  category                  String                      @db.VarChar(128)
  unit                      String                      @db.VarChar(32)
  cost                      Decimal                     @default(0.00) @db.Decimal(12, 2)
  price                     Decimal                     @default(0.00) @db.Decimal(12, 2)
  stock                     Int                         @default(0)
  company_id                Int
  shop                      String?                     @db.VarChar(128)
  status                    products_status             @default(Active)
  marketing_product_ads_log marketing_product_ads_log[]
  marketing_user_product    marketing_user_product[]

  @@index([company_id], map: "idx_products_company")
}

model promotion_items {
  id             Int      @id @default(autoincrement())
  promotion_id   Int
  product_id     Int
  quantity       Int      @default(1)
  is_freebie     Boolean  @default(false)
  price_override Decimal? @db.Decimal(12, 2)

  @@index([product_id], map: "fk_pitems_product")
  @@index([promotion_id], map: "fk_pitems_promotion")
}

model promotions {
  id          Int       @id @default(autoincrement())
  sku         String?   @db.VarChar(64)
  name        String    @db.VarChar(255)
  description String?   @db.Text
  company_id  Int
  active      Boolean   @default(true)
  start_date  DateTime? @db.DateTime(0)
  end_date    DateTime? @db.DateTime(0)

  @@index([active], map: "idx_promotions_active")
  @@index([company_id], map: "idx_promotions_company")
  @@index([start_date, end_date], map: "idx_promotions_dates")
}

model role_permissions {
  role        String    @id @db.VarChar(64)
  data        String    @db.Text
  description String?   @db.Text
  updated_by  Int?
  updated_at  DateTime? @default(now()) @db.DateTime(0)

  @@index([updated_at], map: "idx_role_permissions_updated")
}

model roles {
  id          Int       @id @default(autoincrement())
  code        String    @unique(map: "code") @db.VarChar(64)
  name        String    @db.VarChar(128)
  description String?   @db.Text
  is_active   Boolean?  @default(true)
  is_system   Boolean?  @default(false)
  created_at  DateTime? @default(now()) @db.DateTime(0)
  updated_at  DateTime? @default(now()) @db.DateTime(0)
  users       users[]

  @@index([is_active], map: "idx_roles_active")
  @@index([code], map: "idx_roles_code")
}

model statement_batchs {
  id           Int      @id @default(autoincrement())
  company_id   Int
  user_id      Int?
  row_count    Int
  transfer_min DateTime @db.DateTime(0)
  transfer_max DateTime @db.DateTime(0)
  created_at   DateTime @default(now()) @db.DateTime(0)

  @@index([company_id, created_at], map: "idx_statement_batchs_company_created")
}

model statement_logs {
  id                       Int                       @id @default(autoincrement())
  batch_id                 Int
  transfer_at              DateTime                  @db.DateTime(0)
  amount                   Decimal                   @db.Decimal(12, 2)
  bank_account_id          Int?
  bank_display_name        String?                   @db.VarChar(150)
  channel                  String?                   @db.VarChar(64)
  description              String?                   @db.Text
  created_at               DateTime                  @default(now()) @db.DateTime(0)
  cod_documents            cod_documents[]
  statement_reconcile_logs statement_reconcile_logs?

  @@index([bank_account_id, transfer_at], map: "idx_statement_logs_bank_date")
  @@index([batch_id, transfer_at], map: "idx_statement_logs_batch_transfer")
}

model statement_reconcile_batches {
  id                       Int                        @id @default(autoincrement())
  document_no              String                     @unique(map: "uniq_statement_reconcile_document") @db.VarChar(120)
  bank_account_id          Int?
  bank_display_name        String?                    @db.VarChar(150)
  company_id               Int
  start_date               DateTime?                  @db.DateTime(0)
  end_date                 DateTime?                  @db.DateTime(0)
  created_by               Int
  created_at               DateTime                   @default(now()) @db.DateTime(0)
  notes                    String?                    @db.Text
  bank_account             bank_account?              @relation(fields: [bank_account_id], references: [id], onUpdate: NoAction, map: "fk_statement_reconcile_bank")
  statement_reconcile_logs statement_reconcile_logs[]

  @@index([bank_account_id], map: "idx_statement_reconcile_bank")
  @@index([company_id, created_at], map: "idx_statement_reconcile_company_created")
}

model statement_reconcile_logs {
  id                          Int                         @id @default(autoincrement())
  batch_id                    Int
  statement_log_id            Int                         @unique(map: "uniq_statement_log")
  order_id                    String?                     @db.VarChar(32)
  reconcile_type              String                      @default("Order") @db.VarChar(20)
  statement_amount            Decimal                     @db.Decimal(12, 2)
  confirmed_amount            Decimal?                    @db.Decimal(12, 2)
  auto_matched                Boolean                     @default(false)
  created_at                  DateTime                    @default(now()) @db.DateTime(0)
  confirmed_at                DateTime?                   @db.DateTime(0)
  confirmed_order_id          String?                     @db.VarChar(100)
  confirmed_order_amount      Decimal?                    @db.Decimal(10, 2)
  confirmed_payment_method    String?                     @db.VarChar(50)
  confirmed_action            String?                     @db.VarChar(50)
  statement_reconcile_batches statement_reconcile_batches @relation(fields: [batch_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_statement_reconcile_batch")
  orders                      orders?                     @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_statement_reconcile_order")
  statement_logs              statement_logs              @relation(fields: [statement_log_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_statement_reconcile_statement")

  @@index([batch_id], map: "idx_statement_reconcile_batch")
  @@index([order_id, statement_log_id], map: "idx_statement_reconcile_order_statement")
  @@index([reconcile_type], map: "idx_statement_reconcile_type")
}

model stock_movements {
  id              Int      @id @default(autoincrement())
  warehouse_id    Int
  product_id      Int
  movement_type   String   @db.VarChar(100)
  quantity        Int
  lot_number      String?  @db.VarChar(128)
  reference_type  String?  @db.VarChar(64)
  reference_id    String?  @db.VarChar(64)
  reason          String?  @db.VarChar(255)
  notes           String?  @db.Text
  created_by      Int
  created_at      DateTime @default(now()) @db.DateTime(0)
  document_number String?  @db.VarChar(50)

  @@index([product_id], map: "fk_stock_movements_product")
  @@index([created_by], map: "fk_stock_movements_user")
  @@index([warehouse_id], map: "fk_stock_movements_warehouse")
  @@index([created_at], map: "idx_stock_movements_date")
  @@index([movement_type], map: "idx_stock_movements_type")
}

model stock_reservations {
  id           Int                       @id @default(autoincrement())
  warehouse_id Int
  product_id   Int
  order_id     String?                   @db.VarChar(32)
  quantity     Int
  lot_number   String?                   @db.VarChar(128)
  reserved_at  DateTime                  @default(now()) @db.DateTime(0)
  expires_at   DateTime?                 @db.DateTime(0)
  status       stock_reservations_status @default(ACTIVE)
  created_by   Int
  created_at   DateTime                  @default(now()) @db.DateTime(0)

  @@index([order_id], map: "fk_stock_reservations_order")
  @@index([product_id], map: "fk_stock_reservations_product")
  @@index([created_by], map: "fk_stock_reservations_user")
  @@index([warehouse_id], map: "fk_stock_reservations_warehouse")
  @@index([status], map: "idx_stock_reservations_status")
}

model stock_transaction_images {
  id                 Int                @id @default(autoincrement())
  transaction_id     Int
  image_path         String             @db.VarChar(255)
  stock_transactions stock_transactions @relation(fields: [transaction_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_transaction_images_header")

  @@index([transaction_id], map: "transaction_id")
}

model stock_transaction_items {
  id                 Int                                     @id @default(autoincrement())
  transaction_id     Int
  product_id         Int
  warehouse_id       Int
  lot_id             Int?
  quantity           Decimal                                 @db.Decimal(10, 2)
  adjustment_type    stock_transaction_items_adjustment_type
  remarks            String?                                 @db.VarChar(255)
  stock_transactions stock_transactions                      @relation(fields: [transaction_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_transaction_items_header")

  @@index([transaction_id], map: "transaction_id")
}

model stock_transactions {
  id                       Int                        @id @default(autoincrement())
  document_number          String                     @unique(map: "document_number") @db.VarChar(50)
  type                     stock_transactions_type
  transaction_date         DateTime                   @db.DateTime(0)
  notes                    String?                    @db.Text
  created_by               Int?
  created_at               DateTime                   @default(now()) @db.Timestamp(0)
  updated_at               DateTime                   @default(now()) @db.Timestamp(0)
  stock_transaction_images stock_transaction_images[]
  stock_transaction_items  stock_transaction_items[]
}

model tags {
  id    Int       @id @default(autoincrement())
  name  String    @db.VarChar(128)
  type  tags_type
  color String?   @db.VarChar(20)
}

model user_daily_attendance {
  id                 BigInt                                  @id @default(autoincrement())
  user_id            Int
  work_date          DateTime                                @db.Date
  first_login        DateTime?                               @db.DateTime(0)
  last_logout        DateTime?                               @db.DateTime(0)
  login_sessions     Int                                     @default(0)
  effective_seconds  Int                                     @default(0)
  percent_of_workday Decimal?                                @db.Decimal(5, 2)
  attendance_value   Decimal                                 @default(0.0) @db.Decimal(3, 1)
  attendance_status  user_daily_attendance_attendance_status @default(absent)
  computed_at        DateTime                                @default(now()) @db.DateTime(0)
  updated_at         DateTime                                @default(now()) @db.DateTime(0)

  @@unique([user_id, work_date], map: "uniq_user_date")
  @@index([work_date], map: "idx_work_date")
}

model user_login_history {
  id               BigInt    @id @default(autoincrement())
  user_id          Int
  login_time       DateTime  @default(now()) @db.DateTime(0)
  ip_address       String?   @db.VarChar(45)
  user_agent       String?   @db.Text
  logout_time      DateTime? @db.DateTime(0)
  last_activity    DateTime? @db.DateTime(0)
  session_duration Int?

  @@index([last_activity], map: "idx_last_activity")
  @@index([login_time], map: "idx_login_time")
  @@index([user_id], map: "idx_login_user_id")
}

model user_pancake_mapping {
  id         Int      @id @default(autoincrement())
  id_user    Int      @unique(map: "uniq_user")
  id_panake  String   @unique(map: "uniq_panake")
  created_at DateTime @default(now()) @db.DateTime(0)

  @@index([id_panake], map: "idx_panake")
  @@index([id_user], map: "idx_user")
}

model user_permission_overrides {
  id                                                Int       @id @default(autoincrement())
  user_id                                           Int
  permission_key                                    String    @db.VarChar(128)
  permission_value                                  Json
  notes                                             String?   @db.Text
  created_by                                        Int?
  created_at                                        DateTime? @default(now()) @db.DateTime(0)
  updated_at                                        DateTime? @default(now()) @db.DateTime(0)
  users_user_permission_overrides_created_byTousers users?    @relation("user_permission_overrides_created_byTousers", fields: [created_by], references: [id], onUpdate: NoAction, map: "fk_user_permission_creator")
  users_user_permission_overrides_user_idTousers    users     @relation("user_permission_overrides_user_idTousers", fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_user_permission_user")

  @@unique([user_id, permission_key], map: "uniq_user_permission")
  @@index([created_by], map: "fk_user_permission_creator")
  @@index([permission_key], map: "idx_user_overrides_key")
  @@index([user_id], map: "idx_user_permission_user")
}

model user_tags {
  user_id Int
  tag_id  Int

  @@id([user_id, tag_id])
  @@index([tag_id], map: "fk_user_tags_tag")
}

model user_tokens {
  id         Int       @id @default(autoincrement())
  user_id    Int
  token      String    @unique(map: "uniq_token") @db.VarChar(64)
  expires_at DateTime  @db.DateTime(0)
  created_at DateTime? @default(now()) @db.DateTime(0)
  users      users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_token_user")

  @@index([user_id], map: "idx_user")
}

model users {
  id                                                                    Int                         @id @default(autoincrement())
  username                                                              String                      @unique(map: "username") @db.VarChar(64)
  password                                                              String?                     @db.VarChar(255)
  first_name                                                            String                      @db.VarChar(128)
  last_name                                                             String                      @db.VarChar(128)
  email                                                                 String?                     @db.VarChar(255)
  phone                                                                 String?                     @db.VarChar(64)
  role                                                                  String                      @db.VarChar(64)
  role_id                                                               Int?
  company_id                                                            Int
  team_id                                                               Int?
  supervisor_id                                                         Int?
  id_oth                                                                String?
  status                                                                users_status                @default(active)
  created_at                                                            DateTime?                   @default(now()) @db.DateTime(0)
  updated_at                                                            DateTime?                   @default(now()) @db.DateTime(0)
  last_login                                                            DateTime?                   @db.DateTime(0)
  login_count                                                           Int                         @default(0)
  cod_documents                                                         cod_documents[]
  commission_records                                                    commission_records[]
  marketing_product_ads_log                                             marketing_product_ads_log[]
  marketing_user_product                                                marketing_user_product[]
  user_permission_overrides_user_permission_overrides_created_byTousers user_permission_overrides[] @relation("user_permission_overrides_created_byTousers")
  user_permission_overrides_user_permission_overrides_user_idTousers    user_permission_overrides[] @relation("user_permission_overrides_user_idTousers")
  user_tokens                                                           user_tokens[]
  roles                                                                 roles?                      @relation(fields: [role_id], references: [id], onDelete: Restrict, onUpdate: NoAction, map: "fk_users_role")

  @@index([company_id], map: "idx_users_company")
  @@index([company_id, role], map: "idx_users_company_role")
  @@index([company_id, status], map: "idx_users_company_status")
  @@index([id_oth], map: "idx_users_id_oth")
  @@index([last_login], map: "idx_users_last_login")
  @@index([phone], map: "idx_users_phone")
  @@index([role], map: "idx_users_role")
  @@index([role_id], map: "idx_users_role_id")
  @@index([status], map: "idx_users_status")
}

model warehouse_stocks {
  id                    Int       @id @default(autoincrement())
  warehouse_id          Int
  product_id            Int
  lot_number            String?   @db.VarChar(128)
  product_lot_id        Int?
  quantity              Int       @default(0)
  reserved_quantity     Int       @default(0)
  available_quantity    Int?
  expiry_date           DateTime? @db.Date
  purchase_price        Decimal?  @db.Decimal(12, 2)
  selling_price         Decimal?  @db.Decimal(12, 2)
  location_in_warehouse String?   @db.VarChar(255)
  notes                 String?   @db.Text
  created_at            DateTime  @default(now()) @db.DateTime(0)
  updated_at            DateTime  @default(now()) @db.DateTime(0)

  @@unique([warehouse_id, product_id, lot_number], map: "uniq_warehouse_product_lot")
  @@index([product_id], map: "fk_warehouse_stocks_product")
  @@index([warehouse_id], map: "fk_warehouse_stocks_warehouse")
  @@index([expiry_date], map: "idx_warehouse_stocks_expiry")
  @@index([quantity], map: "idx_warehouse_stocks_quantity")
}

model warehouses {
  id                    Int      @id @default(autoincrement())
  name                  String   @db.VarChar(255)
  company_id            Int
  address               String   @db.Text
  province              String   @db.VarChar(128)
  district              String   @db.VarChar(128)
  subdistrict           String   @db.VarChar(128)
  postal_code           String?  @db.VarChar(16)
  phone                 String?  @db.VarChar(64)
  email                 String?  @db.VarChar(255)
  manager_name          String?  @db.VarChar(255)
  manager_phone         String?  @db.VarChar(64)
  responsible_provinces String?  @db.Text
  is_active             Boolean  @default(true)
  created_at            DateTime @default(now()) @db.DateTime(0)
  updated_at            DateTime @default(now()) @db.DateTime(0)

  @@index([company_id], map: "fk_warehouses_company")
  @@index([is_active], map: "idx_warehouses_active")
  @@index([province], map: "idx_warehouses_province")
}

enum notifications_type {
  system_maintenance
  system_update
  new_customer_assigned
  customer_ownership_expiring
  customer_follow_up_due
  customer_grade_changed
  new_order_created
  order_status_changed
  order_cancelled
  order_payment_pending
  payment_verification_required
  payment_overdue
  payment_verified
  stock_low
  stock_out
  new_stock_received
  new_promotion_created
  promotion_expiring
  campaign_performance
  team_target_achieved
  team_member_performance
  new_team_member
  daily_report_ready
  weekly_report_ready
  monthly_report_ready
  page_engagement_drop
  page_reach_increase
  unanswered_messages
  weekly_page_report
  high_performing_post
  low_performing_post
  scheduled_post_reminder
  facebook_policy_alert
  new_customer_from_page
  customer_inquiry_from_page
  customer_complaint_from_page
  customer_review_from_page
  pancake_api_connection_issue
  page_data_sync_success
  page_data_sync_failure
  environment_variable_change
}

enum notification_roles_role {
  Admin_Page          @map("Admin Page")
  Telesale
  Supervisor_Telesale @map("Supervisor Telesale")
  Backoffice
  Admin_Control       @map("Admin Control")
  Super_Admin         @map("Super Admin")
  Marketing
}

enum notifications_category {
  system
  sales
  customer
  order
  payment
  inventory
  marketing
  report
  team
  page_performance
  content_management
  customer_interaction
}

enum order_sequences_period {
  day
  month
}

enum stock_transactions_type {
  receive
  adjustment
}

enum tags_type {
  SYSTEM
  USER
}

enum customer_logs_lifecycle_status {
  New
  Old
  FollowUp
  Old3Months
  DailyDistribution
}

enum page_engagement_batch_status {
  pending
  processing
  completed
  failed
}

enum order_boxes_payment_method {
  COD
  Transfer
  PayAfter
  Claim
  FreeGift
}

enum customer_logs_action_type {
  create
  update
  delete
}

enum order_box_collection_logs_change_type {
  CREATE
  AMOUNT_UPDATE
  STATUS_UPDATE
  PAYMENT_UPDATE
  WAIVE_UPDATE
  COLLECT_UPDATE
}

enum order_boxes_status {
  PENDING
  PREPARING
  SHIPPED
  DELIVERED
  RETURNED
  CANCELLED
}

enum stock_transaction_items_adjustment_type {
  add
  reduce
  receive
}

enum notifications_priority {
  low
  medium
  high
  urgent
}

enum stock_reservations_status {
  ACTIVE
  RELEASED
  EXPIRED
}

enum user_daily_attendance_attendance_status {
  absent
  half
  full
}

enum order_item_allocations_status {
  PENDING
  ALLOCATED
  PICKED
  SHIPPED
  CANCELLED
}

enum product_lots_status {
  Active
  Depleted
  Expired
}

enum products_status {
  Active
  Inactive
}

enum order_box_collection_logs_old_payment_method {
  COD
  Transfer
  PayAfter
}

enum order_box_collection_logs_new_payment_method {
  COD
  Transfer
  PayAfter
}

enum users_status {
  active
  inactive
  resigned
}

enum customers_lifecycle_status {
  New
  Old
  FollowUp
  Old3Months
  DailyDistribution
}

enum order_box_collection_logs_old_status {
  PENDING
  PREPARING
  SHIPPED
  DELIVERED
  RETURNED
  CANCELLED
}

enum customers_behavioral_status {
  Hot
  Warm
  Cold
  Frozen
}

enum order_box_collection_logs_new_status {
  PENDING
  PREPARING
  SHIPPED
  DELIVERED
  RETURNED
  CANCELLED
}

enum customers_grade {
  D
  C
  B
  A
  A_ @map("A+")
}

enum orders_payment_method {
  COD
  Transfer
  PayAfter
  Claim
  FreeGift
}

enum orders_payment_status {
  Unpaid
  PendingVerification
  Verified
  PreApproved
  Approved
  Paid
}

enum orders_order_status {
  Pending
  AwaitingVerification
  Confirmed
  Preparing
  Picking
  Shipping
  PreApproved
  Delivered
  Returned
  Cancelled
  Claiming
  BadDebt
}
