-- Schema check helper (generated from Prisma schema)
-- Set target database to check against
-- By default this uses the currently selected database.
-- To force a specific database, replace DATABASE() with your DB name, e.g. 'test_mini_erp'.
SET @target_db := DATABASE();

-- 1) Tables that exist in the target database but are NOT defined in the Prisma schema
-- Tables that exist in the current database but are NOT defined in the Prisma schema
SELECT TABLE_NAME
FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_SCHEMA = @target_db
  AND TABLE_NAME NOT IN ('activities', 'ad_spend', 'address_districts', 'address_geographies', 'address_provinces', 'address_sub_districts', 'appointments', 'bank_account', 'call_history', 'cod_records', 'companies', 'customer_address', 'customer_assignment_history', 'customer_blocks', 'customer_logs', 'customer_tags', 'customers', 'env', 'exports', 'marketing_ads_log', 'marketing_user_page', 'notification_read_status', 'notification_roles', 'notification_settings', 'notification_users', 'notifications', 'onecall_batch', 'onecall_log', 'order_box_collection_logs', 'order_boxes', 'order_item_allocations', 'order_items', 'order_sequences', 'order_slips', 'order_tracking_numbers', 'orders', 'page_engagement_batch', 'page_engagement_log', 'page_list_user', 'page_stats_batch', 'page_stats_log', 'page_user', 'pages', 'platforms', 'product_lots', 'products', 'promotion_items', 'promotions', 'role_permissions', 'statement_batchs', 'statement_logs', 'stock_movements', 'stock_reservations', 'tags', 'user_daily_attendance', 'user_login_history', 'user_pancake_mapping', 'user_tags', 'users', 'warehouse_stocks', 'warehouses');

-- 2) Columns that exist in the target database but are NOT defined in the Prisma schema
-- Columns that exist in the current database but are NOT defined in the Prisma schema
SELECT TABLE_NAME, COLUMN_NAME
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_SCHEMA = @target_db
  AND CONCAT(TABLE_NAME, '.', COLUMN_NAME) NOT IN ('activities.id', 'activities.customer_id', 'activities.timestamp', 'activities.type', 'activities.description', 'activities.actor_name', 'ad_spend.id', 'ad_spend.page_id', 'ad_spend.spend_date', 'ad_spend.amount', 'ad_spend.notes', 'address_districts.id', 'address_districts.name_th', 'address_districts.name_en', 'address_districts.province_id', 'address_districts.created_at', 'address_districts.updated_at', 'address_districts.deleted_at', 'address_geographies.id', 'address_geographies.name', 'address_geographies.created_at', 'address_geographies.updated_at', 'address_geographies.deleted_at', 'address_provinces.id', 'address_provinces.name_th', 'address_provinces.name_en', 'address_provinces.geography_id', 'address_provinces.created_at', 'address_provinces.updated_at', 'address_provinces.deleted_at', 'address_sub_districts.id', 'address_sub_districts.zip_code', 'address_sub_districts.name_th', 'address_sub_districts.name_en', 'address_sub_districts.district_id', 'address_sub_districts.lat', 'address_sub_districts.long', 'address_sub_districts.created_at', 'address_sub_districts.updated_at', 'address_sub_districts.deleted_at', 'appointments.id', 'appointments.customer_id', 'appointments.customer_ref_id', 'appointments.date', 'appointments.title', 'appointments.status', 'appointments.notes', 'bank_account.id', 'bank_account.company_id', 'bank_account.bank', 'bank_account.bank_number', 'bank_account.is_active', 'bank_account.created_at', 'bank_account.updated_at', 'bank_account.deleted_at', 'call_history.id', 'call_history.customer_id', 'call_history.date', 'call_history.caller', 'call_history.status', 'call_history.result', 'call_history.crop_type', 'call_history.area_size', 'call_history.notes', 'call_history.duration', 'cod_records.id', 'cod_records.tracking_number', 'cod_records.delivery_start_date', 'cod_records.delivery_end_date', 'cod_records.cod_amount', 'cod_records.received_amount', 'cod_records.difference', 'cod_records.status', 'cod_records.company_id', 'cod_records.created_by', 'cod_records.created_at', 'cod_records.updated_at', 'companies.id', 'companies.name', 'companies.address', 'companies.phone', 'companies.email', 'companies.tax_id', 'companies.created_at', 'companies.updated_at', 'customer_address.id', 'customer_address.customer_id', 'customer_address.address', 'customer_address.recipient_first_name', 'customer_address.recipient_last_name', 'customer_address.province', 'customer_address.district', 'customer_address.sub_district', 'customer_address.zip_code', 'customer_address.created_at', 'customer_address.updated_at', 'customer_assignment_history.id', 'customer_assignment_history.customer_id', 'customer_assignment_history.user_id', 'customer_assignment_history.assigned_at', 'customer_blocks.id', 'customer_blocks.customer_id', 'customer_blocks.reason', 'customer_blocks.blocked_by', 'customer_blocks.blocked_at', 'customer_blocks.unblocked_by', 'customer_blocks.unblocked_at', 'customer_blocks.active', 'customer_logs.id', 'customer_logs.customer_id', 'customer_logs.bucket_type', 'customer_logs.lifecycle_status', 'customer_logs.assigned_to', 'customer_logs.action_type', 'customer_logs.old_values', 'customer_logs.new_values', 'customer_logs.changed_fields', 'customer_logs.created_by', 'customer_logs.created_at', 'customer_tags.customer_id', 'customer_tags.tag_id', 'customers.customer_id', 'customers.customer_ref_id', 'customers.first_name', 'customers.last_name', 'customers.phone', 'customers.backup_phone', 'customers.email', 'customers.province', 'customers.company_id', 'customers.assigned_to', 'customers.date_assigned', 'customers.date_registered', 'customers.follow_up_date', 'customers.ownership_expires', 'customers.lifecycle_status', 'customers.behavioral_status', 'customers.grade', 'customers.total_purchases', 'customers.total_calls', 'customers.facebook_name', 'customers.line_id', 'customers.street', 'customers.subdistrict', 'customers.district', 'customers.postal_code', 'customers.recipient_first_name', 'customers.recipient_last_name', 'customers.has_sold_before', 'customers.follow_up_count', 'customers.last_follow_up_date', 'customers.last_sale_date', 'customers.is_in_waiting_basket', 'customers.waiting_basket_start_date', 'customers.followup_bonus_remaining', 'customers.is_blocked', 'customers.first_order_date', 'customers.last_order_date', 'customers.order_count', 'customers.is_new_customer', 'customers.is_repeat_customer', 'customers.bucket_type', 'env.id', 'env.key', 'env.value', 'env.created_at', 'env.updated_at', 'exports.id', 'exports.filename', 'exports.file_path', 'exports.orders_count', 'exports.user_id', 'exports.exported_by', 'exports.created_at', 'exports.download_count', 'marketing_ads_log.id', 'marketing_ads_log.page_id', 'marketing_ads_log.user_id', 'marketing_ads_log.date', 'marketing_ads_log.ads_cost', 'marketing_ads_log.impressions', 'marketing_ads_log.reach', 'marketing_ads_log.clicks', 'marketing_ads_log.created_at', 'marketing_ads_log.updated_at', 'marketing_user_page.id', 'marketing_user_page.page_id', 'marketing_user_page.user_id', 'marketing_user_page.created_at', 'marketing_user_page.updated_at', 'notification_read_status.id', 'notification_read_status.notification_id', 'notification_read_status.user_id', 'notification_read_status.read_at', 'notification_read_status.created_at', 'notification_roles.id', 'notification_roles.notification_id', 'notification_roles.role', 'notification_roles.created_at', 'notification_settings.id', 'notification_settings.user_id', 'notification_settings.notification_type', 'notification_settings.in_app_enabled', 'notification_settings.email_enabled', 'notification_settings.sms_enabled', 'notification_settings.business_hours_only', 'notification_settings.created_at', 'notification_settings.updated_at', 'notification_users.id', 'notification_users.notification_id', 'notification_users.user_id', 'notification_users.created_at', 'notifications.id', 'notifications.type', 'notifications.category', 'notifications.title', 'notifications.message', 'notifications.timestamp', 'notifications.is_read', 'notifications.priority', 'notifications.related_id', 'notifications.page_id', 'notifications.page_name', 'notifications.platform', 'notifications.previous_value', 'notifications.current_value', 'notifications.percentage_change', 'notifications.action_url', 'notifications.action_text', 'notifications.metadata', 'notifications.created_at', 'notifications.updated_at', 'onecall_batch.id', 'onecall_batch.startdate', 'onecall_batch.enddate', 'onecall_batch.amount_record', 'onecall_batch.created_at', 'onecall_log.id', 'onecall_log.timestamp', 'onecall_log.duration', 'onecall_log.localParty', 'onecall_log.remoteParty', 'onecall_log.direction', 'onecall_log.phone_telesale', 'onecall_log.batch_id', 'order_box_collection_logs.id', 'order_box_collection_logs.order_box_id', 'order_box_collection_logs.order_id', 'order_box_collection_logs.sub_order_id', 'order_box_collection_logs.box_number', 'order_box_collection_logs.change_type', 'order_box_collection_logs.old_collection_amount', 'order_box_collection_logs.new_collection_amount', 'order_box_collection_logs.old_collected_amount', 'order_box_collection_logs.new_collected_amount', 'order_box_collection_logs.old_waived_amount', 'order_box_collection_logs.new_waived_amount', 'order_box_collection_logs.old_payment_method', 'order_box_collection_logs.new_payment_method', 'order_box_collection_logs.old_status', 'order_box_collection_logs.new_status', 'order_box_collection_logs.notes', 'order_box_collection_logs.created_at', 'order_boxes.id', 'order_boxes.order_id', 'order_boxes.sub_order_id', 'order_boxes.box_number', 'order_boxes.payment_method', 'order_boxes.status', 'order_boxes.cod_amount', 'order_boxes.collection_amount', 'order_boxes.collected_amount', 'order_boxes.waived_amount', 'order_boxes.created_at', 'order_boxes.updated_at', 'order_boxes.shipped_at', 'order_boxes.delivered_at', 'order_item_allocations.id', 'order_item_allocations.order_id', 'order_item_allocations.order_item_id', 'order_item_allocations.product_id', 'order_item_allocations.promotion_id', 'order_item_allocations.is_freebie', 'order_item_allocations.required_quantity', 'order_item_allocations.allocated_quantity', 'order_item_allocations.warehouse_id', 'order_item_allocations.lot_number', 'order_item_allocations.status', 'order_item_allocations.notes', 'order_item_allocations.created_by', 'order_item_allocations.created_at', 'order_item_allocations.updated_at', 'order_items.id', 'order_items.order_id', 'order_items.parent_order_id', 'order_items.creator_id', 'order_items.product_id', 'order_items.product_name', 'order_items.quantity', 'order_items.price_per_unit', 'order_items.discount', 'order_items.net_total', 'order_items.is_freebie', 'order_items.box_number', 'order_items.promotion_id', 'order_items.parent_item_id', 'order_items.is_promotion_parent', 'order_sequences.id', 'order_sequences.company_id', 'order_sequences.period', 'order_sequences.prefix', 'order_sequences.last_sequence', 'order_sequences.updated_at', 'order_slips.id', 'order_slips.amount', 'order_slips.bank_account_id', 'order_slips.transfer_date', 'order_slips.order_id', 'order_slips.url', 'order_slips.created_at', 'order_slips.updated_at', 'order_tracking_numbers.id', 'order_tracking_numbers.order_id', 'order_tracking_numbers.parent_order_id', 'order_tracking_numbers.box_number', 'order_tracking_numbers.tracking_number', 'orders.id', 'orders.customer_id', 'orders.company_id', 'orders.creator_id', 'orders.order_date', 'orders.delivery_date', 'orders.street', 'orders.subdistrict', 'orders.district', 'orders.province', 'orders.postal_code', 'orders.recipient_first_name', 'orders.recipient_last_name', 'orders.shipping_provider', 'orders.shipping_cost', 'orders.bill_discount', 'orders.total_amount', 'orders.payment_method', 'orders.payment_status', 'orders.slip_url', 'orders.amount_paid', 'orders.cod_amount', 'orders.order_status', 'orders.notes', 'orders.ocr_payment_date', 'orders.sales_channel', 'orders.sales_channel_page_id', 'orders.bank_account_id', 'orders.transfer_date', 'orders.warehouse_id', 'page_engagement_batch.id', 'page_engagement_batch.date_range', 'page_engagement_batch.created_at', 'page_engagement_batch.status', 'page_engagement_batch.records_count', 'page_engagement_batch.user_id', 'page_engagement_log.id', 'page_engagement_log.batch_id', 'page_engagement_log.page_id', 'page_engagement_log.date', 'page_engagement_log.inbox', 'page_engagement_log.comment', 'page_engagement_log.total', 'page_engagement_log.new_customer_replied', 'page_engagement_log.customer_engagement_new_inbox', 'page_engagement_log.order_count', 'page_engagement_log.old_order_count', 'page_list_user.id', 'page_list_user.page_id', 'page_list_user.page_user_id', 'page_list_user.status', 'page_list_user.still_in_list', 'page_list_user.created_at', 'page_list_user.updated_at', 'page_stats_batch.id', 'page_stats_batch.date_range', 'page_stats_batch.created_at', 'page_stats_log.id', 'page_stats_log.batch_id', 'page_stats_log.page_id', 'page_stats_log.time_column', 'page_stats_log.new_customers', 'page_stats_log.total_phones', 'page_stats_log.new_phones', 'page_stats_log.total_comments', 'page_stats_log.total_chats', 'page_stats_log.total_page_comments', 'page_stats_log.total_page_chats', 'page_stats_log.new_chats', 'page_stats_log.chats_from_old_customers', 'page_stats_log.web_logged_in', 'page_stats_log.web_guest', 'page_stats_log.orders_count', 'page_user.id', 'page_user.user_id', 'page_user.page_user_id', 'page_user.page_user_name', 'page_user.page_count', 'page_user.created_at', 'page_user.updated_at', 'pages.id', 'pages.page_id', 'pages.name', 'pages.platform', 'pages.page_type', 'pages.url', 'pages.company_id', 'pages.active', 'pages.still_in_list', 'pages.user_count', 'pages.created_at', 'pages.updated_at', 'platforms.id', 'platforms.name', 'platforms.display_name', 'platforms.description', 'platforms.company_id', 'platforms.active', 'platforms.sort_order', 'platforms.show_pages_from', 'platforms.created_at', 'platforms.updated_at', 'product_lots.id', 'product_lots.lot_number', 'product_lots.product_id', 'product_lots.warehouse_id', 'product_lots.purchase_date', 'product_lots.expiry_date', 'product_lots.quantity_received', 'product_lots.quantity_remaining', 'product_lots.unit_cost', 'product_lots.supplier_id', 'product_lots.supplier_invoice', 'product_lots.status', 'product_lots.notes', 'product_lots.created_at', 'product_lots.updated_at', 'products.id', 'products.sku', 'products.name', 'products.description', 'products.category', 'products.unit', 'products.cost', 'products.price', 'products.stock', 'products.company_id', 'products.shop', 'products.status', 'promotion_items.id', 'promotion_items.promotion_id', 'promotion_items.product_id', 'promotion_items.quantity', 'promotion_items.is_freebie', 'promotion_items.price_override', 'promotions.id', 'promotions.sku', 'promotions.name', 'promotions.description', 'promotions.company_id', 'promotions.active', 'promotions.start_date', 'promotions.end_date', 'role_permissions.role', 'role_permissions.data', 'statement_batchs.id', 'statement_batchs.company_id', 'statement_batchs.user_id', 'statement_batchs.row_count', 'statement_batchs.transfer_min', 'statement_batchs.transfer_max', 'statement_batchs.created_at', 'statement_logs.id', 'statement_logs.batch_id', 'statement_logs.transfer_at', 'statement_logs.amount', 'statement_logs.channel', 'statement_logs.description', 'statement_logs.created_at', 'stock_movements.id', 'stock_movements.warehouse_id', 'stock_movements.product_id', 'stock_movements.movement_type', 'stock_movements.quantity', 'stock_movements.lot_number', 'stock_movements.reference_type', 'stock_movements.reference_id', 'stock_movements.reason', 'stock_movements.notes', 'stock_movements.created_by', 'stock_movements.created_at', 'stock_reservations.id', 'stock_reservations.warehouse_id', 'stock_reservations.product_id', 'stock_reservations.order_id', 'stock_reservations.quantity', 'stock_reservations.lot_number', 'stock_reservations.reserved_at', 'stock_reservations.expires_at', 'stock_reservations.status', 'stock_reservations.created_by', 'stock_reservations.created_at', 'tags.id', 'tags.name', 'tags.type', 'user_daily_attendance.id', 'user_daily_attendance.user_id', 'user_daily_attendance.work_date', 'user_daily_attendance.first_login', 'user_daily_attendance.last_logout', 'user_daily_attendance.login_sessions', 'user_daily_attendance.effective_seconds', 'user_daily_attendance.percent_of_workday', 'user_daily_attendance.attendance_value', 'user_daily_attendance.attendance_status', 'user_daily_attendance.computed_at', 'user_daily_attendance.updated_at', 'user_login_history.id', 'user_login_history.user_id', 'user_login_history.login_time', 'user_login_history.ip_address', 'user_login_history.user_agent', 'user_login_history.logout_time', 'user_login_history.session_duration', 'user_pancake_mapping.id', 'user_pancake_mapping.id_user', 'user_pancake_mapping.id_panake', 'user_pancake_mapping.created_at', 'user_tags.user_id', 'user_tags.tag_id', 'users.id', 'users.username', 'users.password', 'users.first_name', 'users.last_name', 'users.email', 'users.phone', 'users.role', 'users.company_id', 'users.team_id', 'users.supervisor_id', 'users.id_oth', 'users.status', 'users.created_at', 'users.updated_at', 'users.last_login', 'users.login_count', 'users.user_pancake_mapping', 'warehouse_stocks.id', 'warehouse_stocks.warehouse_id', 'warehouse_stocks.product_id', 'warehouse_stocks.lot_number', 'warehouse_stocks.product_lot_id', 'warehouse_stocks.quantity', 'warehouse_stocks.reserved_quantity', 'warehouse_stocks.available_quantity', 'warehouse_stocks.expiry_date', 'warehouse_stocks.purchase_price', 'warehouse_stocks.selling_price', 'warehouse_stocks.location_in_warehouse', 'warehouse_stocks.notes', 'warehouse_stocks.created_at', 'warehouse_stocks.updated_at', 'warehouses.id', 'warehouses.name', 'warehouses.company_id', 'warehouses.address', 'warehouses.province', 'warehouses.district', 'warehouses.subdistrict', 'warehouses.postal_code', 'warehouses.phone', 'warehouses.email', 'warehouses.manager_name', 'warehouses.manager_phone', 'warehouses.responsible_provinces', 'warehouses.is_active', 'warehouses.created_at', 'warehouses.updated_at');
