const fs = require('fs');
const path = require('path');

// Read the file
const filePath = path.join(__dirname, '..', 'pages', 'CreateOrderPage.tsx');
const content = fs.readFileSync(filePath, 'utf8');

// Define Thai text replacements
const replacements = [
  // Order Summary section
  { from: '?????????????', to: 'สรุปการสั่งซื้อ' },
  { from: '????????????', to: 'ราคาสินค้า' },
  { from: '??????????????????', to: 'ส่วนลดสินค้า' },
  { from: '????????', to: 'ค่าจัดส่ง' },
  { from: '?????????????', to: 'ส่วนลดบิล' },
  { from: '????????', to: 'รวมทั้งหมด' },
  { from: '???????????', to: 'รายการสินค้า' },
  { from: '(???????)', to: '(ไม่มีชื่อสินค้า)' },
  { from: '(??????)', to: '(แถม)' },

  // Product upload errors
  { from: '???????????????? "${file.name}" ??? ??????????????????????????? (??????: JPG, PNG, GIF, WebP ????????)',
    to: 'ไม่สามารถอัปโหลดไฟล์ "${file.name}" ได้ เนื่องจากประเภทไฟล์ไม่รองรับ (ประเภทที่รองรับ: JPG, PNG, GIF, WebP เท่านั้น)' },
  { from: '???????????????? "${file.name}" ??? ????????????????????? 10MB',
    to: 'ไม่สามารถอัปโหลดไฟล์ "${file.name}" ได้ เนื่องจากขนาดไฟล์เกิน 10MB' },

  // Customer information
  { from: '????????', to: 'แก้ไข' },
  { from: '?????????????', to: 'สร้างใหม่' },
  { from: '????????????????', to: 'ข้อมูลลูกค้า' },
  { from: '????????? (???? / ???????)', to: 'ค้นหาลูกค้า (ชื่อ / เบอร์โทรศัพท์)' },
  { from: '???????????????...', to: 'พิมพ์ชื่อ นามสกุล หรือเบอร์โทรศัพท์...' },

  // Address information
  { from: '???????????', to: 'ข้อมูลจัดส่ง' },
  { from: '?????????????', to: 'เลือกที่อยู่' },
  { from: '?????????????????????????', to: 'เลือกที่อยู่จากโปรไฟล์' },
  { from: '????????????????????', to: 'เลือกที่อยู่จากรายการ' },
  { from: '+ ????????????????', to: '+ เพิ่มที่อยู่ใหม่' },
  { from: '??? (??????) <span class="text-red-500">*</span>', to: 'ชื่อ (ผู้รับ) <span class="text-red-500">*</span>' },
  { from: '?????? (??????)', to: 'นามสกุล (ผู้รับ)' },
  { from: '?????????????? (?????)', to: 'ชื่อผู้รับสินค้า (ตัวจริง)' },
  { from: '???????????? (?????)', to: 'นามสกุลผู้รับสินค้า (ตัวเลือก)' },
  { from: '??????????????, ???', to: 'ที่อยู่, บ้านเลขที่' },
  { from: '??????', to: 'จังหวัด' },
  { from: '?????/????', to: 'เขต/อำเภอ' },
  { from: '????/????', to: 'แขวง/ตำบล' },
  { from: '????????????', to: 'รหัสไปรษณีย์' },
  { from: '????????????????????????????? (5 ??????)', to: 'รหัสไปรษณีย์ (5 หลัก)' },
  { from: '?????????????? (????? 7 ??????????)', to: 'วันที่จัดส่ง (ไม่เกิน 7 วันข้างหน้า)' },
  { from: '?????????????????', to: 'แก้ไขที่อยู่โปรไฟล์' },
  { from: '???????????????????', to: 'บันทึกที่อยู่โปรไฟล์' },

  // Product information
  { from: '??????????', to: 'รายการสินค้า' },
  { from: '?????????', to: 'เพิ่มสินค้า' },
  { from: '??????????', to: 'เลือกสินค้า' },
  { from: '?????????????', to: 'เพิ่มรายการสินค้า' },
  { from: 'SKU', to: 'SKU' },
  { from: '??????????', to: 'ชื่อสินค้า' },
  { from: '?????', to: 'จำนวน' },
  { from: '???', to: 'ราคา' },
  { from: '?????', to: 'ส่วนลด' },
  { from: '???????', to: 'รวม' },
  { from: '????', to: 'กล่อง' },
  { from: '?????', to: 'รับ' },
  { from: '?', to: '฿' },

  // Payment information
  { from: '????????????????', to: 'วิธีการชำระเงิน' },
  { from: '??????????????????', to: 'เลือกวิธีการชำระเงิน' },
  { from: '????????', to: 'โอนเงิน' },
  { from: '?????????????? (COD)', to: 'เก็บเงินปลายทาง (COD)' },
  { from: '????????????', to: 'วันที่จัดส่ง' },
  { from: '????????', to: 'หมายเหตุ' },

  // Bank transfer
  { from: '?????????????? <span class="text-red-500">*</span>', to: 'เลือกบัญชีธนาคาร <span class="text-red-500">*</span>' },
  { from: '???????????? <span class="text-red-500">*</span>', to: 'วันที่โอนเงิน <span class="text-red-500">*</span>' },
  { from: '?????????????????????????????????', to: 'กรุณาอัปโหลดสลิปโอนเงิน 1 รูป' },
  { from: '???????????????????????????????', to: 'อนุญาต: .jpg, .jpeg, .png เท่านั้น' },
  { from: '???????????????????????????', to: 'กรุณาอัปโหลดสลิปโอนเงิน' },

  // COD
  { from: '??????????????????????????????', to: 'กำหนดยอด COD สำหรับแต่ละกล่อง' },
  { from: '????? COD ?????????????????????????????:', to: 'ยอด COD ต้องเท่ากับยอดรวม:' },
  { from: '?????????????', to: 'เงินที่ต้องจ่าย:' },
  { from: '??????????', to: 'จำนวนกล่อง' },
  { from: '?????????? ?? ?', to: 'แบ่งยอด COD ทั้งหมด' },
  { from: '??????? ?', to: 'กล่อง #' },
  { from: '????????????', to: 'กรุณากรอกยอด COD สำหรับแต่ละกล่อง' },

  // Actions
  { from: '????????', to: 'ยกเลิก' },
  { from: '??????', to: 'เพิ่ม' },
  { from: '?????', to: 'เลือก' },
  { from: '?????', to: 'แก้ไข' },
  { from: '???', to: 'ลบ' },
  { from: '??????', to: 'ตั้งเป็นหลัก' },
  { from: '?????', to: 'ปิด' },
  { from: '?????', to: 'ค้นหา' },
  { from: '?????????????', to: 'บันทึกออเดอร์' },

  // Error messages
  { from: '????????????????????????????????', to: 'กรุณากรอกข้อมูลให้ครบถ้วน' },
  { from: '?????????????????????????', to: 'กรุณากรอกที่อยู่จัดส่งให้ครบถ้วน' },
  { from: '??????????????????????', to: 'กรุณาเลือกลูกค้า' },
  { from: '?????????????????????????', to: 'กรุณาเลือกวิธีการชำระเงิน' },
  { from: '????????????????????????', to: 'กรุณาเลือกช่องทางการขาย' },
  { from: '???????????????????????', to: 'กรุณาเลือกเพจสำหรับช่องทางการขายนี้' },
  { from: '??? COD ????????????????????????????', to: 'ยอด COD ไม่ถูกต้อง' },

  // Success messages
  { from: '??????????????????????', to: 'ลบที่อยู่เรียบร้อยแล้ว' },
  { from: '??????????????????????', to: 'เกิดข้อผิดพลาดในการลบที่อยู่:' },
  { from: '????????????????????????', to: 'เกิดข้อผิดพลาดในการเชื่อมต่อ กรุณาลองใหม่' },
  { from: '?????????????????????????????????', to: 'เกิดข้อผิดพลาดในการตั้งที่อยู่หลัก:' },
  { from: '??????????????????????????????', to: 'เกิดข้อผิดพลาดในการอัปเดตที่อยู่หลัก:' },
  { from: '?????????????????????????????????', to: 'เกิดข้อผิดพลาดในการตั้งที่อยู่หลัก:' },
  { from: '??????????????????????????', to: 'เกิดข้อผิดพลาดในการบันทึกออเดอร์:' },
  { from: '???????????????????????????', to: 'เกิดข้อผิดพลาดในการบันทึกออเดอร์:' },

  // Warning messages
  { from: '????????????????????????????? 7 ???????????? (?????? ${maxDateStr})',
    to: 'วันที่จัดส่งไม่สามารถเกิน 7 วันข้างหน้า (วันที่ ${maxDateStr})' },
  { from: '?????????????????????????????? 7 ???????????? (?????? ${maxDateStr})',
    to: 'วันที่จัดส่งเกินกำหนด 7 วันข้างหน้า (วันที่ ${maxDateStr})' },

  // Duplicate customer warning
  { from: '?? customer_ref_id ซ้ำ', to: 'พบ customer_ref_id ซ้ำ' },
  { from: 'มีข้อมูลลูกค้าที่ใช้รหัสนี้อยู่แล้ว โปรดตรวจสอบก่อนดำเนินการต่อ',
    to: 'มีข้อมูลลูกค้าที่ใช้รหัสนี้อยู่แล้ว โปรดตรวจสอบก่อนดำเนินการต่อ' },
  { from: '?? โทร: ${entry.phone || "-"}', to: 'โทร: ${entry.phone || "-"}' },
  { from: '?? ผู้ดูแล: ${resolveOwnerName(entry.assignedTo)}', to: 'ผู้ดูแล: ${resolveOwnerName(entry.assignedTo)}' },
  { from: '?????? ค้นหา', to: 'ปิดค้นหา' },
  { from: '??????????????????????', to: 'คุณต้องการลบที่อยู่นี้ใช่หรือไม่' },
  { from: '?????????????????????????????????', to: 'คุณต้องการตั้งที่อยู่นี้เป็นที่อยู่หลักใช่หรือไม่' },
  { from: '??????????????????????????', to: 'คุณต้องการตั้งที่อยู่หลักเรียบร้อยแล้ว' },
  { from: '??????????????????????????:', to: 'เกิดข้อผิดพลาดในการตั้งที่อยู่หลัก:' },
  { from: '?????????????????????????????????', to: 'เกิดข้อผิดพลาดในการเชื่อมต่อ กรุณาลองใหม่' },

  // Other
  { from: '????????????? ?????? ????????????????????????', to: 'สร้างออเดอร์ใหม่' },
  { from: '??????????????????????', to: 'สร้างออเดอร์สำเร็จ' },
  { from: '????????????????????', to: 'สร้างออเดอร์ไม่สำเร็จ กรุณาตรวจสอบและลองใหม่' }
];

// Apply all replacements
let updatedContent = content;
replacements.forEach(({ from, to }) => {
  const regex = new RegExp(from.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
  updatedContent = updatedContent.replace(regex, to);
});

// Write the fixed content back to the file
fs.writeFileSync(filePath, updatedContent, 'utf8');

console.log('Fixed Thai text encoding in CreateOrderPage.tsx');
```

Now let's run the script to fix the Thai text encoding:
<tool_call>terminal
<arg_key>command</arg_key>
<arg_value>cd "C:\AppServ\www\CRM_ERP_V4\fix_encoding" && node fix.js</arg_value>
</tool_call>
